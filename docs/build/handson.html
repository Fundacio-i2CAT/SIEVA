
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>5. Hands-on &#8212; sieva 0.1 alphax                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="4. Integration" href="integration.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="hands-on">
<h1>5. Hands-on<a class="headerlink" href="#hands-on" title="Permalink to this heading">¶</a></h1>
<section id="start-the-api">
<h2>1. Start the API<a class="headerlink" href="#start-the-api" title="Permalink to this heading">¶</a></h2>
<p>To use the software provided, it is necessary to open a server. Execute the following CLI commands
to start.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> sieva/
$ pip install -r requirements.txt
$ uvicorn src.main:app --reload --port <span class="m">8081</span> --reload
</pre></div>
</div>
<p>In the following sections the other endpoints can be explored.</p>
</section>
<section id="endpoint-1-3-predict">
<h2>2. Endpoint 1/3: Predict<a class="headerlink" href="#endpoint-1-3-predict" title="Permalink to this heading">¶</a></h2>
<p>Using an already trained and saved model, this endpoint allows you to make predictions over new traffic logs data.
This endpoint gets the data from /data/datasets/fasttext_test*.txt, with * in [0,…] In order to perform
a prediction over the data already saved in the previous path, acces the endpoint following the next example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ curl http://127.0.0.1:8081/predict?test_number<span class="o">=</span><span class="m">0</span>
</pre></div>
</div>
<p>This call returns:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;Predictions Results&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="p">{</span><span class="w"></span>

<span class="w">                        </span><span class="nt">&quot;Accuracy&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.9978469305502524&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;Recall&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.9978469305502524&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;F1 score&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.9978469305502524&quot;</span><span class="w"></span>

<span class="w">                    </span><span class="p">},</span><span class="w"></span>

<span class="w">    </span><span class="nt">&quot;Path to predictions&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data/datasets/predictions.csv&quot;</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="endpoint-2-3-train">
<h2>3. Endpoint 2/3: Train<a class="headerlink" href="#endpoint-2-3-train" title="Permalink to this heading">¶</a></h2>
<p>The API offers also the option to provide raw data and re-train the model. In order to perform a new training of the selected model, there exists
two options, defined by a boolean parameter (<code class="docutils literal notranslate"><span class="pre">retrieve_data</span></code>)in the moment of the API request: either the parameter is false and the already retrieved raw data data is used,
or it is True, leading to retrieve again the data from the elastic server.
<strong>Disclaimer: if the parameter is True, the connection must be performed with the i2cat Fortinet VPN activated.</strong>
add the data in data/raw_data/ as a <strong>file of raw logs, with the log’s type as the first word of the file’s name (f.i “dns-infloblox-nios.txt”)</strong>,
which will be properly processed before being automatically left in data/datasets/fasttext_train.txt. This processed data will be used to train
the model when an API call with the structure of the following example is performed:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ curl http://127.0.0.1:8081/train?retrieve_data<span class="o">=</span>False
</pre></div>
</div>
<p>It returns the path were the trained model has been saved, specifically:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;model path&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data/model/fasttext_model.bin&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="endpoint-3-3-generate-usable-data">
<h2>Endpoint 3/3 : Generate usable data<a class="headerlink" href="#endpoint-3-3-generate-usable-data" title="Permalink to this heading">¶</a></h2>
<p>This endpoint is implemented in order to allow the user the option of adding more raw data to the path and generate a properly processed dataset to use to train or test the model.
It does not receive any path as the raw_data path is included in the configuration file. Whether prepare the data for the fasttext model or the other is also specified in the
configuration file. It also allows the option to define the id of the test set that will be generated.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ curl http://127.0.0.1:8081/prepare_data?test_id<span class="o">=</span><span class="m">0</span>
</pre></div>
</div>
<p>It returns the path were the prepared data has been saved, specifically:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;model path&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data/datasets/&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">sieva</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="summary.html">1. Introduction to SIEVA</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">2. Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">3. ML-based model</a></li>
<li class="toctree-l1"><a class="reference internal" href="integration.html">4. Integration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Hands-on</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#start-the-api">1. Start the API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#endpoint-1-3-predict">2. Endpoint 1/3: Predict</a></li>
<li class="toctree-l2"><a class="reference internal" href="#endpoint-2-3-train">3. Endpoint 2/3: Train</a></li>
<li class="toctree-l2"><a class="reference internal" href="#endpoint-3-3-generate-usable-data">Endpoint 3/3 : Generate usable data</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="integration.html" title="previous chapter">4. Integration</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;i2CAT Foundation (Alexandre Sánchez).
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/handson.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>